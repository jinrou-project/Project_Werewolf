<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>canvas</title>
<script>
    var ws = new WebSocket("ws://localhost:8080/wstest1/DrawServlet");
    ws.onopen = function(){
        // 接続時の処理
    };
    var isMouseDown = false;
    var canvas;
    var context;
    window.onload = function() {
        canvas = document.getElementById("canvas1");
        context = canvas.getContext('2d');
        canvas.addEventListener("mousemove", function(event){
            mouseX = event.pageX;
            mouseY = event.pageY;
            if(isMouseDown){
                draw(mouseX, mouseY);
                ws.send(mouseX + "," + mouseY);
            }
        });
        canvas.addEventListener("mousedown", function(){
            isMouseDown = true;
        });
        canvas.addEventListener("mouseup", function(){
            isMouseDown = false;
        });
    }
 
    // 描画処理
    function draw(x, y){
        context.beginPath();
        context.fillStyle = "#0099ff";
        context.arc(x, y, 10, 0, Math.PI*2, false);
        context.fill();
    }
 
    ws.onmessage = function(message){
        // 受信時の処理
        var value = message.data.split(",");
        draw(value[0], value[1]);
 
    };
 
    // 接続解除
    function closeConnect(){
        ws.close();
    }
 
</script>
</head>
<body>
    <div>
        <canvas id="canvas1" width="500" height="400" style="background-color:#999999;">
        </canvas>
    </div>
    <input type="button" value="接続解除" onclick="closeConnect()">
 
</body>
</html>